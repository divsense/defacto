{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 373779b8e4a337051003","webpack:///./src/internal/nsf.js","webpack:///./src/internal/tst-checks.js","webpack:///./src/internal/index.js","webpack:///external \"ramda\"","webpack:///./src/internal/tst.js"],"names":["R","require","BRANCH_CLASS","BRANCH_NODES","BRANCH_ID","NO_ORDER","LEVEL_ORDER","DEPTH_FIRST","isProp","node_props","filter_props","some","a","p","isOpt","node","opt","prop","u","k","findById","data","id","i","length","_id","childNodes","concat","b","reduce","m","map","traverseLevelOrder","root","options","level","callback","chs","res","n","traverseDepthFirst","ll","pass","take","props","obj","Object","keys","push","makeNode","params","set","s","t","setChildNodes","parentId","cids","side","branchName","find","e","forEach","exports","findIndex","Array","isArray","byId","has","key","value","prepResEQfromParent","f","Error","assertNextState","cs","ns","nt","traverseDepthPure","fromParent","prep_call","compute_call","siblings_computed","prepTraverseCompute","prepRes","c","children_computed","traversePure","nextCall","states","nodeType","current_state","node_type","next_state","el","stateMachine","next","ensureAll","arr","preset","o","str","mmapToMap","Map","fastFind","nodeId","get"],"mappings":"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","file":"defactoInternal.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"ramda\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"defactoInternal\", [\"ramda\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"defactoInternal\"] = factory(require(\"ramda\"));\n\telse\n\t\troot[\"defactoInternal\"] = factory(root[\"ramda\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_10__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 373779b8e4a337051003","//\n// Divsense Nodes Storage Format\n//\nconst R = require('ramda');\n\nvar BRANCH_CLASS = 0;\nvar BRANCH_NODES = 1;\nvar BRANCH_ID = 2;\n\nvar NO_ORDER = 0;\nvar LEVEL_ORDER = 1;\nvar DEPTH_FIRST = 2;\n\nvar isProp = function( node_props, filter_props ){\n\n  if( node_props && filter_props ){\n    return node_props.some(function(a){\n      var p =  filter_props[ a[0] ];\n      return ( p && p[ a[1] ] );\n    });\n  }\n\n  return false;\n};\n\nvar isOpt = function( node, opt, prop ){\n  return isProp( node.u, opt[prop].u ) || isProp( node.k, opt[prop].k );\n};\n\nvar findById = function( data ){\n  return function( id ){\n    for(var i = 0; i < data.length; i++ ){\n      if( data[i]._id === id ){\n        return data[i];\n      }\n    }\n  };\n};\n\n// This traverses the Array every time it needs to find something.\n// @todo build similar using fastFind\nvar childNodes = function( node, data ){\n\n  return ( (node.a || [] ).concat( (node.b || []) ) )\n    .reduce( function(m,b){\n      return m.concat( b[1] );\n    }, [])\n    .map( findById(data) );\n\n};\n\nvar traverseLevelOrder = function( root, data, options, level, callback ){\n\n  var chs = childNodes( root, data );\n\n  var res = chs.some( function(n){\n    return !!callback( null, n, level );\n  });\n\n  if( !res ){\n    res = chs.some( function(n){\n      return traverseLevelOrder( n, data, options, (level + 1), callback );\n    });\n  }\n\n  return res;\n};\n\nvar traverseDepthFirst = function( root, data, options, level, callback ){\n\n  var chs = childNodes( root, data );\n\n  return chs.some( function(n){\n\n    var res, ll;\n\n    if( options.pass && isOpt( n, options, \"pass\" ) ){\n      res = traverseDepthFirst( n, data, options, level, callback );\n    }\n    else if( !options.take || isOpt( n, options, \"take\" ) ){\n      if( !callback( null, n, level ) ){\n        res = traverseDepthFirst( n, data, options, level + 1, callback );\n      }\n    }\n\n    return res;\n\n  });\n\n\n};\n\nvar props = function( obj ){\n  return Object.keys( obj ).reduce(function(m,a){\n    m.push( [ a, obj[ a ] ] );\n    return m;\n  }, []);\n};\n\nvar makeNode = function( id, params ){\n\n  return function(set){\n\n    set = set || [];\n\n    var s = {_id: id};\n\n    if( params.t ) s.t = params.t;\n\n    if( params.u ) s.u = props( params.u );\n\n    if( params.k ) s.k = props( params.k );\n\n    set.push( s );\n    return set;\n  };\n};\n\nvar setChildNodes = function( parentId, cids, side, branchName ){\n\n  return function(set){\n\n    side = side || \"a\";\n    branchName = branchName || \"children-mmap\";\n\n    var node = R.find(function(e){return e._id === parentId;}, set);\n\n    if( node ){\n\n      node[ side ] = node[ side ] || [];\n\n      node[ side ].push( [ branchName, cids] );\n\n      cids.forEach( function(id){\n\n        var node = R.find(function(e){return e._id === id;}, set);\n        if( node ){\n          node.p = parentId;\n        }\n\n      });\n    }\n\n    return set;\n  };\n};\n\nexports.findIndex = function( data, options ){\n\n  if( Array.isArray( data ) ){\n    if( options.byId ){\n      for(var i = 0; i < data.length; i++ ){\n        if( data[i]._id === options.byId ){\n          return i;\n        }\n      }\n    }\n  }\n};\n\nexports.has = function( key, value, prop ){\n  return prop.some( function(p){ return (p[0] === key && p[1] === value); });\n};\n\nexports.childNodes = childNodes;\n\nexports.makeNode = makeNode;\nexports.setChildNodes = setChildNodes;\n\n\n\n// WEBPACK FOOTER //\n// ./src/internal/nsf.js","/** Error checking helper for tst.js\n *  This let's tst.js be as clean as possible */\n\nexports.prepResEQfromParent = (p, f) => {\n  if(p === f)\n    throw new Error(\"Do not mutate fromParent inside of 'prep_call' and create \" +\n                        \"a new object instead. Otherwise parent's next state won't \" +\n                        \"be transitioned properly\");\n};\n\nexports.assertNextState = (cs, ns, nt) => {\n  if(!ns) throw new Error(\"There is no state for 'current_state' : \" +\n                          cs + \" 'and node_type' : \" + nt);\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/internal/tst-checks.js","/**\n * \n * Refer to this for different es6 export/import options: \n * http://stackoverflow.com/questions/25494365/es6-javascript-module-export-options\n * \n * Refer to this for how the exporting functionality works:\n *  http://stackoverflow.com/questions/29722270/import-modules-from-files-in-directory\n * \n */\n\nimport * as nsf from './nsf';\nexport {nsf as nsf};\n\nimport * as tst from './tst';\nexport {tst as tst};\n\nimport * as tstChecks from './tst-checks';\nexport {tstChecks as tstChecks};\n\n\n\n// WEBPACK FOOTER //\n// ./src/internal/index.js","module.exports = __WEBPACK_EXTERNAL_MODULE_10__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ramda\"\n// module id = 10\n// module chunks = 1","/* @flow */\n\nimport * as nsf from './nsf.js';\nimport * as c from './tst-checks.js';\n\n/*:: import type { dnode, dmodel, dstate, dstates, dprepRes, \n                   dprepCall, dcomputeCall, dnodeType } \n  from './types.js'; */\n\n//export default exports;\n\n/** ===== This represents a \"Transformative State Tree\" =====\n * These functions are mostly pure. They transform the tree based on state \n * transitions WITHOUT STORING STATE, but only passing it forward\n * Parents can pass data and their state defined in prep_call to children.\n * Siblings compute based on state and can pass computed values to the next \n * sibling via compute_call.\n * When all siblings are done, the final computed value gets returned to parent,\n *  which uses it for its own computation.  */\n\n/** @TODO write up\n * @sig DSNode a => a -> b -> a -> c -> d -> e  */\nexport const traverseDepthPure = ( root /*: dnode */,\n                                   data /*: dmodel */,\n                                   fromParent /*: dprepRes */,\n                                   prep_call /*: dprepCall */,\n                                   compute_call /*: dcomputeCall */\n                                 ) /*: ?{} */ => \n  {\n    const chs = nsf.childNodes(root, data);\n    return chs.reduce( (siblings_computed, node) => prepTraverseCompute(\n      node, data, siblings_computed,\n      fromParent, prep_call, compute_call), null);\n  };\n\n/** \n * @sig dnode n => n, */\nexport const prepTraverseCompute = ( node /*: dnode */,\n                                     data /*: dmodel */,\n                                     siblings_computed /*: {} */,\n                                     fromParent /*: dprepRes */,\n                                     prep_call /*: dprepCall */,\n                                     compute_call /*: dcomputeCall */\n                                   ) /*: dprepRes */ => \n  {\n    const prepRes = prep_call(node, fromParent);\n    c.prepResEQfromParent(prepRes, fromParent); // \n    \n    const children_computed = traverseDepthPure( node, data, prepRes,\n                                                 prep_call, compute_call );\n    \n    return compute_call(node, fromParent, prepRes,\n                        siblings_computed, children_computed);\n  };\n\n// Pure Depth First Traversal with Transformative Parse Tree\nexport const traversePure = (data /*: dmodel */,\n                             prep_call /*: dprepCall */,\n                             compute_call /*: dcomputeCall */\n                            ) /*: dprepRes */ =>\n  { \n    return prepTraverseCompute(data[0], data, {}, {}, prep_call, compute_call);\n  };\n\nexport const nextCall = (states /*: dstates */,\n                         nodeType /*: dnodeType */\n                        )  => (current_state /*: string */,\n                               node /*: dnode */\n                              ) => \n  {\n    const node_type = nodeType(current_state, node);\n    \n    const next_state = states.find(function (el) {\n      return el[0] === current_state && el[1] === node_type;\n    });\n    \n    c.assertNextState(current_state, next_state, node_type);        \n    return next_state[2];\n  };\n\nexport const stateMachine = ( states /*: dstates */,\n                              nodeType /*: dnodeType */\n                            ) /*: {} */ =>\n  {\n    return {\n      states: states,\n      nodeType: nodeType, \n      next : nextCall(states, nodeType)\n    };\n  };\n\n/** @TODO REFACTOR THIS!!!. \n * Make sure that the object 'obj' passed is instantiated and it has all\n * elements specified in the array 'arr' and that the elements are set to\n * preset or empty string if preset is undefined */\nexport const ensureAll = function(obj, arr, preset){\n  obj = obj || {};\n  return arr.reduce((o, str) => {\n    if(!preset)\n      o[str] = o[str] || '';\n    else\n      o[str] = o[str] || preset;\n    \n    return o;\n  }, obj);\n};\n\nexport const mmapToMap = function(data){\n  var m = new Map();\n  \n  if( Array.isArray( data ) ){\n    for(var i = 0; i < data.length; i++ ){\n      m.set(data[i]._id, data[i]);\n    }\n  }else\n    throw new Error(\"An mmap is always an Array\");\n  return m;\n};\n\nexport const fastFind = function( data, nodeId ){\n  if(data instanceof Map)\n    return data.get(nodeId);\n  else throw new Error(\"The func fastFind only expects a Map. Please use mmapToMap\" +\n                       \"to convert to Map first and keep the data locally\");\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/internal/tst.js"],"sourceRoot":""}